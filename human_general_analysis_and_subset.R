##CELL TYPE ANOTATION

FeaturePlot(MV2_1, features = c("NRGN", "GP1BB", "TUBB1"),reduction = "umap")

FeaturePlot(MV2_1, features = c("DCN", "DPT", "LUM", "PDGFRA", "H2B-EGFP", "PRRX1", "COL1A1"),reduction = "umap")

FeaturePlot(MV2_1, features = c("MYH11", "ACTA2", "ITGA8", "MYOCD","CNN1","TAGLN"),reduction = "umap")


FeaturePlot(MV2_1, features = c("PTPRC", "CD52", "CD48", "CD53", "ITGB2", "VAV1"),reduction = "umap")


FeaturePlot(MV2_1, features = c("TYROBP", "FCER1G"),reduction = "umap")

FeaturePlot(MV2_1, features = c("CD2", "LCK"),reduction = "umap")

FeaturePlot(MV2_1, features = c("VWF", "CDH5", "PECAM1"),reduction = "umap")


FeaturePlot(MV2_1, features = c("LYVE1", "PROX1"),reduction = "umap")

FeaturePlot(MV2_1, features = c("IGHG1", "MZB1"),reduction = "umap")

FeaturePlot(MV2_1, features = c("CD38", "CD138","SDC1", "XBP1", "IRF4", "PRDM1", "BLIMP1", "MUM1", "IGHG1", "IGHG2", "IGHG3", "IGHG4", "IGHA1", "IGHA2", "IGHM", "IGLC2", "IGLC3"),reduction = "umap")


FeaturePlot(MV2_1, features = c("CD3E", "CD3D","CD3G","CD4","CD8"),reduction = "umap")

FeaturePlot(MV2_1, features = c("CD3D", "CD3E", "CD3G", "CD2", "CD4", "CD8A", "CD8B", "TCRA", "TCRB", "TCRG", "TCRD", "CD28", "CTLA4", "ICOS", "FOXP3", "GZMB", "PRF1"),reduction = "umap")

FeaturePlot(MV2_1, features = c("CD79A", "CD79B","MS4A1","CD19","CD20"),reduction = "umap")

FeaturePlot(MV2_1, features = c("BTK", "CD19", "CD20", "CD22", "CD79A", "CD79B", "PAX5", "BLNK", "IGHM", "IGHD", "IGHG", "IGHA", "IGHE", "IGLC", "IGKC"),reduction = "umap")

FeaturePlot(MV2_1, features = c("KLRB1", "GZMB"),reduction = "umap")
FeaturePlot(MV2_1, features = c("NKG7", "PRF1", "GZMB", "GZMA", "KLRD1", "KLRC1", "KLRC2", "KLRC3", "KLRB1", "KLRF1", "KIR2DL1", "KIR2DL3", "KIR2DL4", "KIR3DL1", "KIR3DL2", "KIR3DL3", "FCGR3A","NCR1"),reduction = "umap")




FeaturePlot(MV2_1, features = c("CXCR2", "S100A9", "S100A8"),reduction = "umap")
FeaturePlot(MV2_1, features = c("TPSAB1", "CPA3"),reduction = "umap")
FeaturePlot(MV2_1, features = c("KIT", "FCER1A", "TPSAB1", "TPSB2", "CPA3", "CMA1", "HPGDS", "MCPT4", "MCPT6", "MCPT8", "GATA2", "SYK"),reduction = "umap")


FeaturePlot(MV2_1, features = c("CD68","CD163","CD14","CSF1R"),reduction = "umap")


FeaturePlot(MV2_1, features = c("FLT3","ITGAX","ZBTB46","LAMP3","CX3CR1","ITGAM"),reduction = "umap")
FeaturePlot(MV2_1, features = c("CD11c", "CD209","DC-SIGN", "CD83", "CD86", "HLA-DRA", "HLA-DRB1", "HLA-DPA1", "HLA-DPB1", "HLA-DQA1", "HLA-DQB1", "CCR7", "CD40"),reduction = "umap")

FeaturePlot(MV2_1, features = c("MYH7","MYL2"),reduction = "umap")
FeaturePlot(MV2_1, features = c("NRXN3","NRXN1"),reduction = "umap")




FeaturePlot(MV2_1, features = c("HBA1","HBB"),reduction = "umap")


FeaturePlot(MV2_1, features = c("ALAS2", "HBA1", "HBA2", "HBB", "SLC4A1", "ANK1", "SPTB", "EPB42", "GYPB", "GYPA", "GYPE"),reduction = "umap")


FeaturePlot(MV2_1, features = c("CFD","APOD","LIPE"),reduction = "umap")



FeaturePlot(MV2_1, features = c("ADIPOQ","PLIN1","LIPE","CIDEC","RETN","APOC1","PON1","ADIG"),reduction = "umap")





FeaturePlot(MV2_1, features = c("WT1","MUC16","MSLM"),reduction = "umap")
FeaturePlot(MV2_1, features = c("WT1","MUC16"),reduction = "umap")
FeaturePlot(MV2_1, features = c("PDGFRB","CSPG4","MCAM","NES","TBX18","NOTCH3","RGS4","HIGD1B","DCN","DPT", "LUM", "PDGFRA"),reduction = "umap",
            keep.scale = "all")




FeaturePlot(MV2_1,features = c("DCN", "LUM", "DPT", "COL1A1", "COL1A2", "COL3A1", "COL8A1", "COL12A1", "COL14A1", "ELN", "FBN1", "OGN", "POSTN", "VCAN", "BGN", "FMOD", "COMP", "CHAD", "PRELP", "PRG4", "FBLN2", "ACAN", "CTHRC1", "CILP", "BGLAP2", "BGLAP3", "BGLAP", "MGP", "SPON1") , split.by = 'human', pt.size=0.001)

FeaturePlot(MV2_1,features = c("COL1A1", "COL3A1", "COL8A1", "LUM") , split.by = 'human', pt.size=0.001)








##cluster definition:
new.cluster.ids <- c("Fibroblast","Fibroblast", "Fibroblast", "T cell", 
                     "Fibroblast","Fibroblast", "T cell", "T cell", "Macrophage","Macrophage", 
                     "Macrophage", "Fibroblast", 
                     "T cell","Fibroblast", "Fibroblast", "Macrophage", 
                     "T cell","Fibroblast","T cell", "Endothelium", 
                     "Fibroblast","Macrophage", "Fibroblast", "Mast cell",)
names(new.cluster.ids) <- levels(MV2_1)
new.cluster.ids
MV2_1 <- RenameIdents(MV2_1, new.cluster.ids)






library(scCustomize) 
library(viridis)
library(RColorBrewer)
library(gridExtra)


p000 <- Plot_Density_Custom(MV.all2_1, features = "COL1A1", custom_palette = BlueAndRed())


library(tidyverse)
pdf(file = "newcombined012.pdf", width=8, height=5)

my36colors <-c('#E5D2DD', '#53A85F', '#F1BB72', '#F3B1A0', '#D6E7A3', '#57C3F3', '#476D87',
               '#E95C59', '#E59CC4', '#AB3282', '#23452F', '#BD956A', '#8C549C', '#585658',
               '#9FA3A8', '#E0D4CA', '#5F3D69', '#C5DEBA', '#58A4C3', '#E4C755', '#F7F398',
               '#AA9A59', '#E63863', '#E39A35', '#C1E6F3', '#6778AE', '#91D0BE', '#B53E2B',
               '#712820', '#DCC1DD', '#CCE0F5',  '#CCC9E6', '#625D9E', '#68A180', '#3A6963',
               '#968175'
)

a <- VlnPlot(MV.all, features = c("DCN","COL1A1","LUM","CD163","CD68","CDH5","VWF","PECAM1",
                                  "CD3D","CD3E","TPSB2","TPSAB1","CPA3"), 
             stack = TRUE, 
             sort = TRUE, 
             cols = my36colors,
             split.by =  "cell_type" , 
             flip = TRUE) +
  theme(legend.position = "none") + 
  ggtitle("Identity on x-axis")
a
dev.off() 
dev.off() 
dev.off() 


library(scRNAtoolVis)
selected_genes <- c('CCL2', 'CXCL2', 'CXCL1','CCR2', 'COL1A1', 'COL1A2', 'COL3A1', 
                    'COL8A1', 'COL14A1', 'ELN', 'HAS2', 'UGP2', 'UGDH')
AverageHeatmap(object = Fibroblast,
               markerGene = selected_genes,
               cluster_rows = T)



pdf(file = "newcombined02.pdf", width=5, height=8)

my36colors <-c('#E5D2DD', '#53A85F', '#F1BB72', '#F3B1A0', '#D6E7A3', '#57C3F3', '#476D87',
               '#E95C59', '#E59CC4', '#AB3282', '#23452F', '#BD956A', '#8C549C', '#585658',
               '#9FA3A8', '#E0D4CA', '#5F3D69', '#C5DEBA', '#58A4C3', '#E4C755', '#F7F398',
               '#AA9A59', '#E63863', '#E39A35', '#C1E6F3', '#6778AE', '#91D0BE', '#B53E2B',
               '#712820', '#DCC1DD', '#CCE0F5',  '#CCC9E6', '#625D9E', '#68A180', '#3A6963',
               '#968175'
)

a <- VlnPlot(MV.all, features = c("DCN", "CD3D","CD163","CDH5","DCN", "TPSB2"), 
             stack = TRUE, 
             sort = TRUE, 
             cols = my36colors,
             split.by =  "celltype_all" , 
             flip = FALSE) +
  theme(legend.position = "none") + 
  ggtitle("Identity on x-axis")
a
dev.off() 
dev.off() 







## subset   
Macrophage <- subset(MV.all2_1, idents = c("Macrophage"))

Fibroblast <- subset(MV.all2_1, idents = "Fibroblast")
Endothelium <- subset(MV.all2_1, idents = "Endothelium")

